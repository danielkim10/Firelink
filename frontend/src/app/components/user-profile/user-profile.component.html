<div class="row">
    <div flex="100">
        <mat-card>
            <mat-card-content>
                <div class="row">
                    <div class="col s12">
                        <mat-tab-group>
                            <mat-tab label="Overview">
                                <div *ngIf="!editMode">
                                    <div class="row">
                                        <div class="col s6">
                                            <div class="row">
                                                <label>Username: {{user.username}}</label>
                                            </div>
                                            <div class="row">
                                                <label>Email: {{user.email}}</label>
                                            </div>
                                            <div class="row">
                                                <label>Role: {{user?.role?.name}}</label>
                                            </div>
                                            <div class="row">
                                                <label>Description: {{user.description}}</label>
                                            </div>
                                        </div>
                                        <div class="col s6">
                                            <div class="row">
                                                <label>Summoner Name: {{user.summonerName}}</label>
                                            </div>
                                            <div class="row">
                                                <label>Team: {{user?.team?.tag}} - {{user?.team?.name}}</label>
                                            </div>
                                            <div class="row">
                                                <label>Free agent: {{user.freeAgent}}</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <button mat-flat-button color="warn" type="button" (click)="openDialog(user, 'deactivate')">Deactivate</button>
                                        <button mat-flat-button color="accent" type="button" (click)="home()">Home</button>
                                        <button mat-flat-button color="primary" type="button" *ngIf="!editMode" (click)="editProfile()">Edit</button>
                                    </div>
                                </div>

                                <div *ngIf="editMode">
                                    <form #editProfileForm="ngForm" (ngSubmit)="onSubmit(editProfileForm)">
                                        <div class="row">
                                            <mat-form-field>
                                                <mat-label>Username</mat-label>
                                                <input matInput type="text" name="username" #name="ngModel" [(ngModel)]="userEdit.username" value={{userEdit.username}}>
                                            </mat-form-field>
                                        </div>
                                        <div class="row">
                                            <mat-form-field>
                                                <mat-label>Email</mat-label>
                                                <input matInput type="text" name="email" #name="ngModel" [(ngModel)]="userEdit.email" value={{userEdit.email}}> 
                                            </mat-form-field>
                                        </div>
                                        <div class="row">
                                            <mat-form-field>
                                                <mat-label>Role</mat-label>
                                                <mat-select name="role" #name="ngModel" [(ngModel)]="userEdit.role" [(value)]="userEdit.role">
                                                    <mat-option *ngFor="let role of roles" [value]="role._id">
                                                        {{role.name}}
                                                    </mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>
                                        <div class="row">
                                            <mat-form-field>
                                                <mat-label>Description</mat-label>
                                                <textarea matInput name="description" #name="ngModel" [(ngModel)]="userEdit.description" value={{userEdit.description}}></textarea>
                                            </mat-form-field>
                                        </div>
                                        <div class="row">
                                            <mat-form-field>
                                                <mat-label>Summoner Name</mat-label>
                                                <input matInput name="summonerName" #name="ngModel" [(ngModel)]="userEdit.summonerName" type="text" value={{userEdit.summonerName}}>
                                            </mat-form-field>
                                        </div>
                                        
                                        <div class="row">
                                                <label>Free Agent</label>
                                                <mat-checkbox name="freeAgent" #name="ngModel" [(ngModel)]="userEdit.freeAgent"></mat-checkbox>
                                        </div>
                                        <div class="row">
                                            <button mat-flat-button color="warn" type="button" (click)="stopEditing()">Back</button>
                                            <button mat-flat-button color="primary" type="submit">Save</button>
                                        </div>
                                    </form>
                                </div>

                            </mat-tab>
                            <mat-tab label="History">
                                <div class="row">

                                    <mat-card>
                                        <mat-card-header>
                                            <mat-card-title>Team History</mat-card-title>
                                        </mat-card-header>
                                        <mat-card-content>
                                            <table mat-table [dataSource]="user.previousTeams">
                                                <ng-container matColumnDef="name">
                                                    <th mat-header-cell *matHeaderCellDef>Name</th>
                                                    <td mat-cell *matCellDef="let team">{{team.name}}</td>
                                                </ng-container>
                                                <tr mat-header-row *matHeaderRowDef="displayedColumnsTeams"></tr>
                                                <tr mat-row *matRowDef="let row; columns: displayedColumnsTeams;"></tr>
                                            </table>
                                        </mat-card-content>
                                    </mat-card>
                                </div>
                                <div class="row">
                                    <mat-card>
                                        <mat-card-header>
                                            <mat-card-title>Tournament History</mat-card-title>
                                        </mat-card-header>
                                        <mat-card-content>
                                            <table mat-table [dataSource]="user.previousTournaments">
                                                <ng-container matColumnDef="name">
                                                    <th mat-header-cell *matHeaderCellDef>Name</th>
                                                    <td mat-cell *matCellDef="let tournament">{{tournament.name}}</td>
                                                </ng-container>
                                                <tr mat-header-row *matHeaderRowDef="displayedColumnsTourn"></tr>
                                                <tr mat-row *matRowDef="let row; columns: displayedColumnsTourn;"></tr>
                                            </table>
                                        </mat-card-content>
                                    </mat-card>
                                </div>
                                <div class="row">
                                    <mat-card>
                                        <mat-card-header>
                                            <mat-card-title>Match History</mat-card-title>
                                        </mat-card-header>
                                        <mat-card-content>
                                            <table mat-table [dataSource]="user.previousMatches">
                                                <ng-container matColumnDef="name">
                                                    <th mat-header-cell *matHeaderCellDef>Name</th>
                                                    <td mat-cell *matCellDef="let match">{{match.name}}</td>
                                                </ng-container>
                                                <tr mat-header-row *matHeaderRowDef="displayedColumnsMatch"></tr>
                                                <tr mat-row *matRowDef="let row; columns: displayedColumnsMatch;"></tr>
                                            </table>
                                        </mat-card-content>
                                    </mat-card>
                                </div>
                            </mat-tab>
                            <mat-tab label="Notifications">
                                <div class="row">

                                    <mat-drawer-container class="drawer" autosize>
                                        <mat-drawer mode="side" opened>
                                            <mat-tab-group>
                                                <mat-tab label="Notifications">
                                                    <mat-selection-list #notifications1 [multiple]="false">
                                                        <mat-list-option *ngFor="let notification of notifications" [value]="notification">
                                                            <h3 matLine>{{notification.subject}}</h3>
                                                            <p matLine>{{notification.message}}</p>
                                                        </mat-list-option>
                                                    </mat-selection-list>
                                                </mat-tab>
                                                <mat-tab label="Invites">
                                                    <mat-selection-list #invites [multiple]="false">
                                                        <mat-list-option *ngFor="let invite of user.incomingInvites" [value]="invite" class="mat-item">
                                                            <h3 matLine>{{invite.subject}}</h3>
                                                            <p matLine>{{invite.message}}</p>
                                                        </mat-list-option>
                                                    </mat-selection-list>
                                                </mat-tab>
                                            </mat-tab-group>
                                        </mat-drawer>
                                        <mat-drawer-content class="drawer-content">
                                            <div *ngIf="!invites.selectedOptions.selected[0]" class="default-text">
                                                Select a notification or invite to view its contents
                                            </div>
                                            <div *ngIf="invites.selectedOptions.selected[0]" class="default-text">
                                                <div class="row">
                                                    <p>Subject: {{invites.selectedOptions.selected[0]?.value.subject}}</p>
                                                </div>
                                                <div class="row">
                                                    <p>Message: {{invites.selectedOptions.selected[0]?.value.message}}</p>
                                                </div>
                                                <div class="row">
                                                    <button mat-flat-button color="warn" type="button" (click)="declineInvite(invites.selectedOptions.selected[0]?.value)">Decline</button>
                                                    <button mat-flat-button color="primary" type="button" (click)="acceptInvite(invites.selectedOptions.selected[0]?.value)">Accept</button>
                                                </div>
                                            </div>
                                        </mat-drawer-content>
                                    </mat-drawer-container>
                                </div>
                            </mat-tab>
                            <mat-tab label="Settings">
                                <div class="row">
                                    <label>Settings</label>
                                </div>
                            </mat-tab>
                        </mat-tab-group>
                    </div>
                </div>
            </mat-card-content>
        </mat-card>
    </div>
</div>
